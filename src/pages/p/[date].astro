---
import { getAllPuzzleMeta, hasPuzzleDate } from "../../lib/puzzles";
import Layout from "../../components/Layout.astro";
import PuzzleView from "../../components/PuzzleView.astro";

export async function getStaticPaths() {
  const allPuzzles = await getAllPuzzleMeta();
  return allPuzzles.map((puzzle) => ({
    params: { date: puzzle.date },
  }));
}

const { date } = Astro.params;
const base = import.meta.env.BASE_URL;

if (!date) return Astro.redirect(base);

const exists = await hasPuzzleDate(date);
if (!exists) return Astro.redirect(base);
---

<Layout>
  <PuzzleView date={date} />
</Layout>
